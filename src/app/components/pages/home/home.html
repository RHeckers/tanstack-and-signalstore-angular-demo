<section
  class="pokedex"
  aria-labelledby="pokedex-heading"
  data-testId="pokedex-overview"
>
  <header class="pokedex__intro" data-testId="pokedex-intro">
    <div>
      <h2 id="pokedex-heading">Pokedex Demo</h2>

      <section class="pokemon__controls-container">
        <div class="pokemon__type-controls">
          <label for="pokedex-type-filter-select">Explore by type:</label>
          <select
            id="pokedex-type-filter-select"
            [ngModel]="activeType()"
            (change)="onTypeFilterChange($event)"
            data-testId="pokedex-type-filter"
          >
            @for (type of types(); track type) {
              <option [value]="type">
                {{ type | titlecase }}
              </option>
            }
          </select>
        </div>
      </section>
    </div>
  </header>

  <section>
    <label for="add-collection-toggle">Add to collection: </label>
    <input
      type="checkbox"
      id="type-toggle"
      [(ngModel)]="addToCollection"
      data-testId="add-collection-toggle"
    />
  </section>

  @if (loading() && !pokemons().length) {
    <p class="pokedex__status" data-testId="pokedex-loading">
      Loading Pokémon…
    </p>
  } @else if (error()) {
    <p
      class="pokedex__status pokedex__status--error"
      role="alert"
      data-testId="pokedex-error"
    >
      {{ error() }}
    </p>
  } @else {
    <section
      class="pokedex__grid"
      aria-live="polite"
      data-testId="pokedex-grid"
    >
      @for (pokemon of pokemons(); track pokemon.id) {
        <article class="pokedex-card" data-testId="pokemon-card">
          @if (addToCollection()) {
            <button
              type="button"
              class="pokedex-card__add-button"
              aria-label="Add {{ pokemon.name | titlecase }} to collection"
              data-testId="pokemon-add-button"
            >
              +
            </button>
          }
          <a
            [routerLink]="['/pokemon', pokemon.name]"
            class="pokedex-card__link"
            data-testId="pokemon-link"
          >
            <figure class="pokedex-card__media">
              <img
                [src]="pokemon.image"
                [alt]="pokemon.name | titlecase"
                aria-label="Pokemon image"
                width="160"
                height="160"
                loading="lazy"
                data-testId="pokemon-image"
              />
            </figure>
            <div class="pokedex-card__body">
              <h3 data-testId="pokemon-name">
                {{ pokemon.name | titlecase }}
              </h3>
              @if (pokemon.types.length > 0) {
                <ul class="pokedex-card__types" data-testId="pokemon-types">
                  @for (type of pokemon.types; track type) {
                    <li data-testId="pokemon-type">{{ type | titlecase }}</li>
                  }
                </ul>
              }
            </div>
          </a>
        </article>
      }
    </section>
  }
</section>
