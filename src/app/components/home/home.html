<section
  class="pokedex"
  aria-labelledby="pokedex-heading"
  data-testId="pokedex-overview"
>
  <header class="pokedex__intro" data-testId="pokedex-intro">
    <div>
      <h2 id="pokedex-heading">Pokédex demo</h2>
      <p>
        Pokemon are creatures of all shapes and sizes who live in the wild or
        alongside humans. For some people, Pokémon are pets. Browse for your
        favorite Pokémon in the list. Search will filter Pokémon by name on the
        current page.
      </p>
    </div>
  </header>

  <section class="pokemon__paging-container">
    <div>
      <button
        class="pokedex__page-button"
        data-testId="pokedex-prev-page"
        (click)="onPrevPage()"
        [disabled]="activePage() === 1"
      >
        Previous
      </button>
      <span data-testId="pokedex-current-page">
        Page {{ activePage() }} of {{ totalPages() }}
      </span>
      <button
        class="pokedex__page-button"
        data-testId="pokedex-next-page"
        (click)="onNextPage()"
        [disabled]="activePage() === totalPages()"
      >
        Next
      </button>
    </div>

    <div>
      <label for="pokedex-goto-page-input">Pokemon per page:</label>
      <app-number-input
        [maxValue]="totalPokemonCount()"
        [value]="30"
        (valueChange)="onPokemonPerPageChange($event)"
      />
    </div>
  </section>

  @if (loading() && !pokemons().length) {
    <p class="pokedex__status" data-testId="pokedex-loading">
      Loading Pokémon…
    </p>
  } @else if (error()) {
    <p
      class="pokedex__status pokedex__status--error"
      role="alert"
      data-testId="pokedex-error"
    >
      {{ error() }}
    </p>
  } @else {
    @if (filteredPokemons().length === 0) {
      <p class="pokedex__status" data-testId="pokedex-empty">
        No Pokémon match your search.
      </p>
    } @else {
      <section
        class="pokedex__grid"
        aria-live="polite"
        data-testId="pokedex-grid"
      >
        @for (pokemon of filteredPokemons(); track pokemon.id) {
          <article class="pokedex-card" data-testId="pokemon-card">
            <a
              [routerLink]="['/pokemon', pokemon.name]"
              class="pokedex-card__link"
              data-testId="pokemon-link"
            >
              <figure class="pokedex-card__media">
                <img
                  [src]="pokemon.image"
                  [alt]="pokemon.name | titlecase"
                  aria-label="Pokemon image"
                  width="160"
                  height="160"
                  loading="lazy"
                  data-testId="pokemon-image"
                />
              </figure>
              <div class="pokedex-card__body">
                <h3 data-testId="pokemon-name">
                  {{ pokemon.name | titlecase }}
                </h3>
                @if (pokemon.types.length > 0) {
                  <ul class="pokedex-card__types" data-testId="pokemon-types">
                    @for (type of pokemon.types; track type) {
                      <li data-testId="pokemon-type">{{ type | titlecase }}</li>
                    }
                  </ul>
                }
              </div>
            </a>
          </article>
        }
      </section>
    }
  }
</section>
